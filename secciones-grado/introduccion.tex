\customsection{Introducción}
\input{secciones-ante/introduccion}
%\input{secciones-ante/problema}
%\input{secciones-ante/justificacion}
%\input{secciones-ante/objetivos}
\input{secciones-ante/resultadosesperados}

\subsection{Diseño Generalizado}

El sistema se diseñó con las mejores condiciones de: modularidad, costo, tamaño y escalabilidad. Para cada uno de estas características se escogieron tecnologías y se desarrollaron funciones claves. 
\vspace{0.5cm}\\
Desde la perspectiva de la modularidad, se desarrollaron aplicaciones de frontend capaces de integrarse con 2 tipos de protocolos de comunicación: Mqtts y Https; además, para acceder a los servicios de la nube se implementó el servicio de backend en la plataforma ``Google Cloud Plataform'' puesto que permite utilizar de la mejor manera todos los servicios de google: su asistente de voz, su interfaz de inteligencia artificial, sus servicios de autenticación, su red privada de fibra óptica (que es de las más rápidas y de mayor cobertura), entre otros.
\vspace{0.5cm}\\
En cuanto al costo, se utilizaron tecnologías de backend totalmente escalables tipo serverless para ajustar los gastos a únicamente los necesarios, teniendo en cuenta que las pruebas a gran escala estuvieron lejos del alcance de este proyecto, aún así se desarrolló toda la arquitectura pensando en la necesidad de optimizar en la mayor medida los gastos. Teniendo en cuenta que no se hicieron pruebas a gran escala los servicios de backend fueron posibles gracias a las cuotas gratuitas del mayorista utilizado para desplegar el servicio (Google).
\vspace{0.5cm}\\
En cuanto al requerimiento de escalabilidad, la decisión de diseñar serverless jugó el papel más importante: Los servicios servirles le permitieron a la aplicación ser diseñada para permanecer funcional sin hacer ningún cambio inclusive con 4000 usuarios (esta última apreciación es teórica puesto que no se hicieron pruebas a esa escala).
\vspace{0.5cm}\\
Para comprender mejor el producto, se puede observar en la figura \ref{diagramaGeneralizado} un diagrama generalizado de los componentes de software del sistema, donde principalmente los desarrollos hacen parte de 3 grandes bloques: el bloque de la nube, el bloque del dispositivo embebido (Raspberry), y el bloque del dispositivo móvil (Android).
\vspace{0.5cm}\\
\begin{figure}[htbp]
	\centering
	\includegraphics[width=10cm]{figuras/GeneralDiagram.png}
	\caption{Diagrama generalizado de las estructuras de software. Fuente: propia}	
	\label{diagramaGeneralizado}
\end{figure}

El producto del backend se implementó en el servicio de Google Cloud Services y utilizó los siguientes elementos para su funcionamiento: Un ``Storage version 3 system'' conectado a la red privada de Google para el almacenamiento de archivos, Una base de datos relacional MySql para el almacenamiento de datos de monitoreo y control de los dispositivos, una lista de ``funciones de nube''  activadas por solicitudes http y por ellas mismas que se comunican directamente con la base de datos y finalmente, un broker nativo de Google Cloud llamado ``Cloud IOT'' que recibe las conexiones de Mqtt de los dispositivos del sistema.
\vspace{0.5cm}\\
La aplicación móvil desarrollada está compuesta de 3 escenas: la escena de control, utilizada para el manejo de los actuadores disponibles desde el aplicativo en sitio; la escena de medición, encargada de presentarle al usuario las mediciones adquiridas por el aplicativo en sitio en tiempo real; y la escena principal, donde se puede observar un indicador del porcentaje de las variables mas relevantes respecto a un punto de referencia. Por ejemplo, el porcentaje de consumo de agua con respecto al promedio de consumo de agua en un mes de un grupo familiar.
\vspace{0.5cm}\\
Finalmente, el aplicativo en sitio se desarrolló usando Python y se diseñó para manejar un flujo de datos más grandes y la posibilidad de funcionar desconectado de la red. La aplicación le permitió al usuario programar rutinas de control de los circuitos a partir de horarios, visualizar los datos medidos, cambiar parámetros de adquisición como el tamaño del buffer y la frecuencia de muestreo, entre otros.

